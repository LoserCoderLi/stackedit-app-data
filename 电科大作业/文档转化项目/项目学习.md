# 项目学习
## pandoc库了解
要将markdown转化成PDF、HTML、word文件，这个库发挥着不可替代的作用。
### tex文件
想要生成带有封面、带有声明、带有目录以及对代码块等进行个性化调整的PDF文件，需要使用.tex模板文件
我在项目中使用的模板文件是
```
def generate_parameter(title, author, statement, date=""):
    """
    生成包含文档参数的字典，包括标题、作者、声明和日期。

    参数:
    title (str): 文档标题
    author (str): 文档作者
    statement (str): 文档声明
    date (str): 文档日期，如果为空则使用当前日期

    返回:
    dict: 包含标题、作者、声明和日期的字典
    """
    # 如果没有提供日期，则使用当前日期
    if date == "":
        date = datetime.now().strftime("%Y-%m-%d")  # 获取当前日期并格式化为字符串

    # 创建包含文档参数的字典
    dir_parameter = {
        "title": title,
        "author": author,
        "date": date,
        "statement": statement
    }

    # 返回包含文档参数的字典
    return dir_parameter

def generate_latex_document_pdf(left_header, right_header, cover_footer, urlid):
    """
    生成包含指定页眉和封面页脚内容的 LaTeX 文档模板，并将其保存到指定文件。

    参数:
    left_header (str): 页眉左侧内容
    right_header (str): 页眉右侧内容
    cover_footer (str): 封面页脚内容
    filename (str): 保存文件的路径
    """
    # LaTeX 文档模板 初版存放在内存中
    latex_template = f"""
\\usepackage{{fancyhdr}}
\\usepackage{{graphicx}}
\\usepackage{{amsmath}}
\\usepackage{{hyperref}}
\\usepackage{{geometry}}
\\usepackage{{xcolor}}
\\usepackage{{fontspec}}
\\usepackage{{tocloft}}
\\usepackage{{titlesec}}
\\usepackage{{longtable}}
\\usepackage{{booktabs}}
\\usepackage{{listings}}
\\usepackage{{xeCJK}}
\\usepackage{{etoolbox}}
\\usepackage{{array}}
\\usepackage{{caption}}
\\usepackage{{tabularx}}

% 页面布局
\\geometry{{
    a4paper,
    left=25mm,
    right=25mm,
    top=25mm,
    bottom=25mm,
}}

% 设置中文字体
\\setCJKmainfont{{SimSun}}  % 使用宋体作为中文主字体
\\setmainfont{{SimSun}}  % 设置英文字体为宋体

% 页眉页脚设置
\\fancypagestyle{{plain}}{{
    \\fancyhf{{}}
    \\fancyhead[L]{{{left_header}}}
    \\fancyhead[R]{{{right_header}}}
    \\fancyfoot[C]{{\\thepage}}  % 仅显示页码
}}

\\pagestyle{{plain}}

% 字体和颜色设置
\\colorlet{{mycolor}}{{blue}}
\\newcommand{{\\highlight}}[1]{{\\textbf{{\\textcolor{{mycolor}}{{#1}}}}}}

% 行间距设置
\\renewcommand{{\\baselinestretch}}{{1.5}}  % 调整行间距为1.5倍

% 目录设置
\\renewcommand{{\\contentsname}}{{\\centering 目录}}

% 调整目录的样式
\\renewcommand{{\\cftsecfont}}{{\\bfseries\\fontsize{{16pt}}{{16pt}}\\selectfont}}  % 三号字体
\\renewcommand{{\\cftsubsecfont}}{{\\bfseries\\fontsize{{15pt}}{{15pt}}\\selectfont}}  % 小三号字体
\\renewcommand{{\\cftsubsubsecfont}}{{\\bfseries\\fontsize{{15pt}}{{15pt}}\\selectfont}}  % 小三号字体
\\renewcommand{{\\cftsecpagefont}}{{\\bfseries}}
\\renewcommand{{\\cftsubsecpagefont}}{{\\bfseries}}
\\renewcommand{{\\cftsubsubsecpagefont}}{{\\bfseries}}
\\setlength{{\\cftbeforesecskip}}{{0.5em}}
\\setlength{{\\cftbeforesubsecskip}}{{0.2em}}

% 在每个一级标题前插入一个空行
\\pretocmd{{\\section}}{{\\addtocontents{{toc}}{{\\protect\\addvspace{{1.0\\baselineskip}}}}}}{{}}{{}}

% 目录设置为居中
\\renewcommand{{\\cfttoctitlefont}}{{\\hfill\\Huge\\bfseries}}
\\renewcommand{{\\cftaftertoctitle}}{{\\hfill}}

% 章节编号和标题格式
\\titleformat{{\\section}}{{\\normalfont\\Large\\bfseries}}{{\\thesection}}{{1em}}{{}}
\\titleformat{{\\subsection}}{{\\normalfont\\large\\bfseries}}{{\\thesubsection}}{{1em}}{{}}
\\titleformat{{\\subsubsection}}{{\\normalfont\\normalsize\\bfseries}}{{\\thesubsubsection}}{{1em}}{{}}

% 设置目录条目格式
\\setlength{{\\cftsecnumwidth}}{{3em}} % 设置章节编号的宽度
\\setlength{{\\cftsubsecnumwidth}}{{3.5em}} % 设置子章节编号的宽度
\\setlength{{\\cftsubsubsecnumwidth}}{{4em}} % 设置三级章节编号的宽度

% 强制显示章节和子章节编号
\\setcounter{{secnumdepth}}{{3}}
\\setcounter{{tocdepth}}{{3}}

% 调整目录各级标题的缩进
\\cftsetindents{{section}}{{1.5em}}{{3em}}
\\cftsetindents{{subsection}}{{3.5em}}{{3.5em}}
\\cftsetindents{{subsubsection}}{{7em}}{{4em}}

% 表格样式设置
\\captionsetup[table]{{skip=10pt}}
\\newcolumntype{{L}}[1]{{|>{{\\raggedright\\arraybackslash}}p{{#1}}|}}
\\newcolumntype{{C}}[1]{{|>{{\\centering\\arraybackslash}}p{{#1}}|}}
\\newcolumntype{{R}}[1]{{|>{{\\raggedleft\\arraybackslash}}p{{#1}}|}}

% 代码块设置
\\lstset{{
    basicstyle=\\ttfamily,
    breaklines=true,
    frame=single,
    backgroundcolor=\\color{{gray!10}},
    extendedchars=true,
    inputencoding=utf8,
    literate={{一}}{{\\CJKchar{{"4E00}}}}1
             {{二}}{{\\CJKchar{{"4E8C}}}}1
             {{三}}{{\\CJKchar{{"4E09}}}}1
             {{四}}{{\\CJKchar{{"56DB}}}}1
             {{五}}{{\\CJKchar{{"4E94}}}}1
             {{六}}{{\\CJKchar{{"516D}}}}1
             {{七}}{{\\CJKchar{{"4E03}}}}1
             {{八}}{{\\CJKchar{{"516B}}}}1
             {{九}}{{\\CJKchar{{"4E5D}}}}1
             {{零}}{{\\CJKchar{{"96F6}}}}1
}}

% 超链接设置
\\hypersetup{{
    colorlinks=true,
    linkcolor=black,  % 设置链接颜色为黑色
    urlcolor=black,   % 设置 URL 颜色为黑色
    filecolor=black,  % 设置文件链接颜色为黑色
    citecolor=black   % 设置引用颜色为黑色
}}

% 封面页面设置
\\newcommand{{\\coverpage}}[4]{{
    \\begin{{titlepage}}
        \\begin{{flushleft}}
            \\includegraphics[width=0.2\\textwidth]{{#4}}
        \\end{{flushleft}}
        \\centering
        \\vspace{{5cm}}
        {{\\Huge\\bfseries #1 \\par}}
        \\vspace{{1.5cm}}
        {{\\Large #2 \\par}}
        \\vspace{{1.5cm}}
        {{\\Large #3 \\par}}
        \\vfill
        {{\\Large {cover_footer} \\par}}
    \\end{{titlepage}}
}}

% 声明页面设置
\\newcommand{{\\statementpage}}[1]{{
    \\begin{{center}}
        \\vspace*{{2cm}}
        {{\\Large\\bfseries 声明 \\par}}
        \\vspace{{1.5cm}}
        {{\\large #1 \\par}}
        \\vfill
    \\end{{center}}
}}

% 图表标题设置
\\captionsetup[figure]{{
    labelformat=simple,
    labelsep=quad,
    font=small,
    justification=centering,
    format=hang,
    singlelinecheck=off
}}
\\renewcommand\\figurename{{图}}  % 设置图标题的前缀
\\renewcommand\\thefigure{{\\thesection.\\arabic{{figure}}}}  % 设置图编号格式为章节号.图号
\\makeatletter
\\@addtoreset{{figure}}{{section}}  % 在每个章节开始时重置图片编号
\\makeatother

    """

    filename = urlid + "/document_pdf.tex"

    # 检查文件路径的目录是否存在，如果不存在则创建目录
    os.makedirs(os.path.dirname(filename), exist_ok=True)

    # 打开文件进行写入，如果文件不存在则创建文件
    with open(filename, "w", encoding="utf-8") as file:
        file.write(latex_template)
    print(f"File '{filename}' has been created/overwritten with the provided content.")

    return filename

```
为了在频繁的调用原文件进行个性化修改下，提高效率，我将原文件放在了内存里面，而不是外存，这样可以更高效。

### css文件
为了进行HTML的文件转化，我们依旧要设置模板文件

<!--stackedit_data:
eyJoaXN0b3J5IjpbNDQ4NjEzNTEzXX0=
-->